{"version":3,"file":"action.min.js","sources":["../src/action.js"],"sourcesContent":["define(['jquery','core/ajax'], function ($, Ajax) {\n    'use strict';\n    return {\n        init: function () {\n            $('button[name=action-btn]').click(function () {\n\n                var deviceId = $(this).attr('data-id');\n                var action = $(this).attr('data-action');\n                var btn = $(this);\n                var spanText = $('#span-' + deviceId);\n                var dataAction = 'sus';\n                if (action == 'sus') {\n                    dataAction = 'act';\n                }\n\n                if (action === 'del') {\n                    if (confirm(\"Are You sure you want to delete record ?\") == true) {\n\n\n\n                        var requestArgs = {\n                            deviceid: parseInt(deviceId),\n                            action: action.toString()\n                        };\n\n                        Ajax.call([{\n                            methodname: 'local_secureaccess_update_labs',\n                            args: requestArgs\n                        }])[0].then(function () {\n                            $('#tr-' + deviceId).fadeOut(300);\n                        }).catch(function (err) {\n                            let error = `<span>AJAX Error: ${err} <span><br><span>\n                    Error: ${err.message}</span><br><span>Args were :${requestArgs}</span>`;\n                            $('#ajx-err').html(error);\n\n                        });\n\n                    }\n                    else {\n\n                    }\n                }\n                else {\n\n\n                    var requestArgs = {\n                        deviceid: parseInt(deviceId),\n                        action: action.toString()\n                    };\n\n                    Ajax.call([{\n                        methodname: 'local_secureaccess_update_labs',\n                        args: requestArgs\n                    }])[0].then(function () {\n                        if (action != 'del') {\n                            btn.attr('data-action', dataAction);\n                            btn.toggleClass('btn-warning btn-success');\n                            if (btn.html() === \"Suspend\") {\n                                btn.html(\"Activate\");\n                                spanText.html(\"Inactive\");\n                            } else {\n                                btn.html(\"Suspend\");\n                                spanText.html(\"Active\");\n                            }\n\n                            spanText.toggleClass('text-success text-danger');\n                        }\n\n\n                    }).catch(function (err) {\n                        let error = `<span>AJAX Error: ${err} <span><br><span> Error:\n                      ${err.message}</span><br><span>Args were :${requestArgs}</span>`;\n                        $('#ajx-err').html(error);\n                    });\n\n                }\n\n            });\n\n\n            $(\"button[name=admin-btn]\").click(function () {\n\n                var dataAction = $(this).attr('data-action');\n                var btn = $(this);\n                var deviceId = $(this).attr('data-id');\n                var lab = btn.attr('data-lab');\n                var action = 'admin';\n\n                var confirmString = '';\n\n\n\n\n\n                if (dataAction == 'mkadmin') {\n                    confirmString = \"Are You sure you want to make this device Admin ?\";\n\n                }\n                else {\n                    confirmString = \"Are You sure you want to Remove this device From Admin ?\";\n                }\n\n                if (confirm(confirmString) == true) {\n\n\n\n                    var requestArgs = {\n                        deviceid: parseInt(deviceId, 10),   // ensure number\n                        action: action.toString(),\n                        dataaction: dataAction.toString(),\n                        lab: parseInt(lab, 10)\n                    };\n\n                    Ajax.call([{\n                        methodname: 'local_secureaccess_update_labs',\n                        args: requestArgs\n                    }])[0].then(function (e) {\n\n                        if (e.status == 1) {\n                            btn.toggleClass('btn-primary btn-secondary');\n                            if (dataAction === \"mkadmin\") {\n                                dataAction = \"rmadmin\";\n                                btn.html(\"Remove Admin\");\n                                btn.attr('data-action', 'rmadmin');\n                            }\n                            else if (dataAction === \"rmadmin\") {\n                                btn.html(\"Make Admin\");\n                                btn.attr('data-action', 'mkadmin');\n                            }\n                        }\n\n\n                    }).catch(function (err) {\n                        let error = `<span>AJAX Error: ${err} <span><br><span>\n                      Error: ${err.message}</span><br><span>Args were :${requestArgs}</span>`;\n                        $('#ajx-err').html(error);\n                    });\n\n                }\n            });\n        }\n    };\n});\n\n/*$(document).ready(function () {\n    $('button[name=action-btn]').click(function () {\n\n        var deviceId = $(this).attr('data-id');\n        var action = $(this).attr('data-action');\n        var btn = $(this);\n        var spanText = $('#span-' + deviceId);\n        var dataAction = 'sus';\n        if (action == 'sus') {\n            dataAction = 'act';\n        }\n\n        if (action === 'del') {\n            if (confirm(\"Are You sure you want to delete record ?\") == true) {\n\n                require(['core/ajax'], function (Ajax) {\n\n                    var requestArgs = {\n                        deviceid: parseInt(deviceId),\n                        action: action.toString()\n                    };\n\n                    Ajax.call([{\n                        methodname: 'local_secureaccess_update_labs',\n                        args: requestArgs\n                    }])[0].then(function (e) {\n                        $('#tr-' + deviceId).fadeOut(300);\n                    }).catch(function (err) {\n                        console.error(\"AJAX Error:\", err);\n                        console.error(\"Error: \" + err.message);\n                        console.error(\"Args were:\", requestArgs);\n                    });\n                });\n            }\n            else {\n\n            }\n        }\n        else {\n            require(['core/ajax'], function (Ajax) {\n\n                var requestArgs = {\n                    deviceid: parseInt(deviceId),\n                    action: action.toString()\n                };\n\n                Ajax.call([{\n                    methodname: 'local_secureaccess_update_labs',\n                    args: requestArgs\n                }])[0].then(function (e) {\n                    if (action != 'del') {\n                        btn.attr('data-action', dataAction);\n                        btn.toggleClass('btn-warning btn-success');\n                        if (btn.html() === \"Suspend\") {\n                            btn.html(\"Activate\");\n                            spanText.html(\"Inactive\");\n                        } else {\n                            btn.html(\"Suspend\");\n                            spanText.html(\"Active\");\n                        }\n\n                        spanText.toggleClass('text-success text-danger');\n                    }\n\n\n                }).catch(function (err) {\n                    console.error(\"AJAX Error:\", err);\n                    console.error(\"Error: \" + err.message);\n                    console.error(\"Args were:\", requestArgs);\n                });\n            });\n        }\n\n    });\n\n\n    $(\"button[name=admin-btn]\").click(function () {\n\n        var dataAction = $(this).attr('data-action');\n        var btn = $(this);\n        var deviceId = $(this).attr('data-id');\n        var lab = btn.attr('data-lab');\n        var action = 'admin';\n        var sesskey = $('#sesskey').val();\n        var confirmString = '';\n\n\n        console.log('dataAction: ' + dataAction + '\\n' + 'deviceId: '\n            + deviceId + '\\n' + 'lab: ' + lab + '\\n' + 'action: ' + action);\n\n\n        if (dataAction == 'mkadmin') {\n            confirmString = \"Are You sure you want to make this device Admin ?\";\n\n        }\n        else {\n            confirmString = \"Are You sure you want to Remove this device From Admin ?\";\n        }\n\n        if (confirm(confirmString) == true) {\n\n            require(['core/ajax'], function (Ajax) {\n\n                var requestArgs = {\n                    deviceid: parseInt(deviceId, 10),   // ensure number\n                    action: action.toString(),\n                    dataaction: dataAction.toString(),\n                    lab: parseInt(lab, 10)\n                };\n\n                Ajax.call([{\n                    methodname: 'local_secureaccess_update_labs',\n                    args: requestArgs\n                }])[0].then(function (e) {\n                    console.log(e);\n                    if (e.status == 1) {\n                        btn.toggleClass('btn-primary btn-secondary');\n                        if (dataAction === \"mkadmin\") {\n                            dataAction = \"rmadmin\";\n                            btn.html(\"Remove Admin\");\n                            btn.attr('data-action', 'rmadmin');\n                        }\n                        else if (dataAction === \"rmadmin\") {\n                            btn.html(\"Make Admin\");\n                            btn.attr('data-action', 'mkadmin');\n                        }\n                    }\n\n\n                }).catch(function (err) {\n                    console.error(\"AJAX Error:\", err);\n                    console.error(\"Error: \" + err.message);\n                    console.error(\"Args were:\", requestArgs);\n                });\n            });\n        }\n    });\n});*/"],"names":["define","$","Ajax","init","click","deviceId","this","attr","action","btn","spanText","dataAction","confirm","requestArgs","deviceid","parseInt","toString","call","methodname","args","then","fadeOut","catch","err","error","message","html","toggleClass","lab","confirmString","dataaction","e","status"],"mappings":"AAAAA,mCAAO,CAAC,SAAS,cAAc,SAAUC,EAAGC,YAEjC,CACHC,KAAM,WACFF,EAAE,2BAA2BG,OAAM,eAE3BC,SAAWJ,EAAEK,MAAMC,KAAK,WACxBC,OAASP,EAAEK,MAAMC,KAAK,eACtBE,IAAMR,EAAEK,MACRI,SAAWT,EAAE,SAAWI,UACxBM,WAAa,SACH,OAAVH,SACAG,WAAa,OAGF,QAAXH,WAC2D,GAAvDI,QAAQ,4CAAqD,KAIzDC,YAAc,CACdC,SAAUC,SAASV,UACnBG,OAAQA,OAAOQ,YAGnBd,KAAKe,KAAK,CAAC,CACPC,WAAY,iCACZC,KAAMN,eACN,GAAGO,MAAK,WACRnB,EAAE,OAASI,UAAUgB,QAAQ,QAC9BC,OAAM,SAAUC,SACXC,kCAA6BD,6DAChCA,IAAIE,+CAAsCZ,uBAC3CZ,EAAE,YAAYyB,KAAKF,eAS1B,CAGGX,YAAc,CACdC,SAAUC,SAASV,UACnBG,OAAQA,OAAOQ,YAGnBd,KAAKe,KAAK,CAAC,CACPC,WAAY,iCACZC,KAAMN,eACN,GAAGO,MAAK,WACM,OAAVZ,SACAC,IAAIF,KAAK,cAAeI,YACxBF,IAAIkB,YAAY,2BACG,YAAflB,IAAIiB,QACJjB,IAAIiB,KAAK,YACThB,SAASgB,KAAK,cAEdjB,IAAIiB,KAAK,WACThB,SAASgB,KAAK,WAGlBhB,SAASiB,YAAY,gCAI1BL,OAAM,SAAUC,SACXC,kCAA6BD,+DACjCA,IAAIE,+CAAsCZ,uBAC1CZ,EAAE,YAAYyB,KAAKF,cAQ/BvB,EAAE,0BAA0BG,OAAM,eAE1BO,WAAaV,EAAEK,MAAMC,KAAK,eAC1BE,IAAMR,EAAEK,MACRD,SAAWJ,EAAEK,MAAMC,KAAK,WACxBqB,IAAMnB,IAAIF,KAAK,YAGfsB,cAAgB,MAOhBA,cADc,WAAdlB,WACgB,oDAIA,2DAGU,GAA1BC,QAAQiB,eAAwB,KAI5BhB,YAAc,CACdC,SAAUC,SAASV,SAAU,IAC7BG,OAtBK,QAsBUQ,WACfc,WAAYnB,WAAWK,WACvBY,IAAKb,SAASa,IAAK,KAGvB1B,KAAKe,KAAK,CAAC,CACPC,WAAY,iCACZC,KAAMN,eACN,GAAGO,MAAK,SAAUW,GAEF,GAAZA,EAAEC,SACFvB,IAAIkB,YAAY,6BACG,YAAfhB,YACAA,WAAa,UACbF,IAAIiB,KAAK,gBACTjB,IAAIF,KAAK,cAAe,YAEJ,YAAfI,aACLF,IAAIiB,KAAK,cACTjB,IAAIF,KAAK,cAAe,gBAKjCe,OAAM,SAAUC,SACXC,kCAA6BD,+DAC1BA,IAAIE,+CAAsCZ,uBACjDZ,EAAE,YAAYyB,KAAKF"}