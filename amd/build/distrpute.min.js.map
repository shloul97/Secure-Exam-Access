{"version":3,"file":"distrpute.min.js","sources":["../src/distrpute.js"],"sourcesContent":["define(['jquery', 'core/ajax'], function ($, Ajax) {\n    'use strict';\n    return {\n        init: function () {\n\n\n            // -------- Form Submit\n            $('.mform').submit(function (e) {\n                e.preventDefault();\n\n                var data = $(this).serializeArray();\n                var labs = [];\n                var quizes = [];\n\n                //labs and course debugging\n                let course_debug = data.find(x => x.name === \"course\")?.value;\n                let labs_debug = data.filter(x => x.name === \"labs[]\").map(x => x.value);\n\n                if(!course_debug.length|| labs_debug.length <= 0){\n                    alert(\"Please Select Course and Labs\");\n                    return;\n                }\n\n                $(this).find('input[name=\"labs[]\"]:checked').each(function () {\n                    labs.push($(this).val());\n                });\n\n                $(this).find('input[name=\"quizes[]\"]:checked').each(function () {\n                    quizes.push($(this).val());\n                });\n\n                var usersArgs = {\n                    courseid: parseInt(data[2].value),\n                    labs: labs,\n                    quiz: quizes\n                };\n\n                Ajax.call([{\n                    methodname: 'local_restrict_get_users',\n                    args: usersArgs\n                }])[0].then(function (res) {\n                    var msgDiv = $('.msg-div');\n                    msgDiv.removeClass('msg-err msg-success');\n\n                    if (res.status === 0) {\n                        msgDiv.html(res.message).addClass('msg-err').fadeIn(200);\n                    } else {\n                        msgDiv.html(res.message).addClass('msg-success').fadeIn(200);\n                    }\n\n                }).catch(function (err) {\n                    let fullError = `\n                                    <div style=\"color:red;\">\n                                        <strong>AJAX Error:</strong><br>\n                                        Message: ${err.message || 'N/A'}<br>\n                                        Status: ${err.status || 'N/A'}<br>\n                                        Status Text: ${err.statusText || 'N/A'}<br>\n                                        Response: ${err.responseText || JSON.stringify(err)}<br>\n                                        Arguments: ${JSON.stringify(usersArgs)}\n                                    </div>\n                                `;\n                    $('#ajx-err').html(fullError);\n                });\n\n            });\n\n            // -------- Course Change\n            $('input[name=course]').change(function () {\n                var val = parseInt($(this).val());\n\n                // Get Quizes\n                var quizesArgs = {\n                    courseid: val\n                };\n                Ajax.call([{\n                    methodname: 'local_restrict_get_quizes',\n                    args: quizesArgs\n                }])[0].then(function (res) {\n                    let html = '';\n                    if (res.status == 1) {\n                        $.each(res.message, function (index, value) {\n                            html += `<div class=\"form-check form-check-inline\" data-id=\"${index}\">\n                                <input class=\"form-check-input\" name=\"quizes[]\" type=\"checkbox\"\n                                id=\"checkbox${value.id}\" value=\"${value.id}\">\n                                <label class=\"form-check-label\" for=\"checkbox${value.id}\">${value.name}</label>\n                            </div>`;\n                        });\n                        $('#quizes-div').html(html);\n                    }\n\n                }).catch(function (err) {\n                    let fullError = `\n                                    <div style=\"color:red;\">\n                                        <strong>AJAX Error:</strong><br>\n                                        Message: ${err.message || 'N/A'}<br>\n                                        Status: ${err.status || 'N/A'}<br>\n                                        Status Text: ${err.statusText || 'N/A'}<br>\n                                        Response: ${err.responseText || JSON.stringify(err)}<br>\n                                        Arguments: ${JSON.stringify(quizesArgs)}\n                                    </div>\n                                `;\n                    $('#ajx-err').html(fullError);\n                });\n            });\n        }\n    };\n});"],"names":["define","$","Ajax","init","submit","e","preventDefault","data","this","serializeArray","labs","quizes","course_debug","find","x","name","_data$find","value","labs_debug","filter","map","length","alert","each","push","val","usersArgs","courseid","parseInt","quiz","call","methodname","args","then","res","msgDiv","removeClass","status","html","message","addClass","fadeIn","catch","err","fullError","statusText","responseText","JSON","stringify","change","quizesArgs","index","id"],"mappings":"AAAAA,kCAAO,CAAC,SAAU,cAAc,SAAUC,EAAGC,YAElC,CACHC,KAAM,WAIFF,EAAE,UAAUG,QAAO,SAAUC,kBACzBA,EAAEC,qBAEEC,KAAON,EAAEO,MAAMC,iBACfC,KAAO,GACPC,OAAS,OAGTC,gCAAeL,KAAKM,MAAKC,GAAgB,WAAXA,EAAEC,oCAAjBC,WAAqCC,MACpDC,WAAaX,KAAKY,QAAOL,GAAgB,WAAXA,EAAEC,OAAmBK,KAAIN,GAAKA,EAAEG,YAE9DL,aAAaS,QAASH,WAAWG,QAAU,EAC3CC,MAAM,sCAIVrB,EAAEO,MAAMK,KAAK,gCAAgCU,MAAK,WAC9Cb,KAAKc,KAAKvB,EAAEO,MAAMiB,UAGtBxB,EAAEO,MAAMK,KAAK,kCAAkCU,MAAK,WAChDZ,OAAOa,KAAKvB,EAAEO,MAAMiB,cAGpBC,UAAY,CACZC,SAAUC,SAASrB,KAAK,GAAGU,OAC3BP,KAAMA,KACNmB,KAAMlB,QAGVT,KAAK4B,KAAK,CAAC,CACPC,WAAY,2BACZC,KAAMN,aACN,GAAGO,MAAK,SAAUC,SACdC,OAASlC,EAAE,YACfkC,OAAOC,YAAY,uBAEA,IAAfF,IAAIG,OACJF,OAAOG,KAAKJ,IAAIK,SAASC,SAAS,WAAWC,OAAO,KAEpDN,OAAOG,KAAKJ,IAAIK,SAASC,SAAS,eAAeC,OAAO,QAG7DC,OAAM,SAAUC,SACXC,+MAG2BD,IAAIJ,SAAW,uEAChBI,IAAIN,QAAU,4EACTM,IAAIE,YAAc,yEACrBF,IAAIG,cAAgBC,KAAKC,UAAUL,yEAClCI,KAAKC,UAAUtB,6FAGhDzB,EAAE,YAAYqC,KAAKM,kBAM3B3C,EAAE,sBAAsBgD,QAAO,eAIvBC,WAAa,CACbvB,SAJMC,SAAS3B,EAAEO,MAAMiB,QAM3BvB,KAAK4B,KAAK,CAAC,CACPC,WAAY,4BACZC,KAAMkB,cACN,GAAGjB,MAAK,SAAUC,SACdI,KAAO,GACO,GAAdJ,IAAIG,SACJpC,EAAEsB,KAAKW,IAAIK,SAAS,SAAUY,MAAOlC,OACjCqB,mEAA8Da,kKAE5ClC,MAAMmC,uBAAcnC,MAAMmC,+FACOnC,MAAMmC,gBAAOnC,MAAMF,wDAG1Ed,EAAE,eAAeqC,KAAKA,UAG3BI,OAAM,SAAUC,SACXC,+MAG2BD,IAAIJ,SAAW,uEAChBI,IAAIN,QAAU,4EACTM,IAAIE,YAAc,yEACrBF,IAAIG,cAAgBC,KAAKC,UAAUL,yEAClCI,KAAKC,UAAUE,8FAGhDjD,EAAE,YAAYqC,KAAKM"}